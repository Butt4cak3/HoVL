{"version":3,"sources":["../src/scene.ts","../src/vector.ts","../src/shapes.ts","verlet/main.ts"],"names":[],"mappings":";AAUA,MAAM;IAiBJ,YAAY,MAAyB;ACpBvC,MAAM,EDMM,WAAM,GAAY,CCNP,CDMS,ACNS,CDMR,CCNU,CAAU;IACnD,EAAE,CAAC,CDQK,ACRJ,OAAO,CAAC,KDQI,ACRC,GDQY,EAAE,CAAC,EAAE,ACRT,CDQU,ACRT,CAAC,CDQU,ACRT,CDQU,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC;AEhB7E,OAAO,CF4BH,ACnBA,CCTK,GF4BD,CAAC,CCnBC,CCTK,ADSJ,ECTM,ADSJ,CAAC,CDmBC,CCnBC,CAAC,CDmBC,CCnBC,CAAC,IDmBI,ACnBA,CDmBC,GCnBG,CAAC,CAAC,CAAC,CAAC,CCTK,ADSJ,CAAC,CAAC,CAAC,EAAE,CAAC;ACDvC,IDEE,CAAC,CCFG,EFqBF,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;AG7B9D,IDeE,ADLE,GEVG,CH+BH,ACrBI,CAAC,AEVA,CFUC,IDqBA,AG/BI,EDgBV,AChBY,CH+BH,GAAG,CEfC,EACb,EAAE,CFcgB,CAAC,OEdR,GFckB,AEdf,CFcgB,IAAI,CAAC,AEdf,ACjBW,CH+BK,AEdf,CAAC,EAAE,CAAC,CAAC,EAAE,MAAM,GAAG,CAAC,EAAE,KAAK,GAAG,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAgB;AChBhF,OAAO,CH+BH,AEbA,ADRA,CEVK,CH+BH,CAAC,CAAC,AEbA,CAAC,AClBI,CFUH,CDqBC,AG/BI,CH+BH,CAAC,CAAC,AEbA,GAAG,AClBI,EAAE,GDkBD,CAAC,MDRP,CAAC,EAAG,eEVuB;AAC3C,IFUE,CAAC,EEVI,CDmBH,CCnBK,GH+BH,AEZE,CAAC,ECnBM,CH+BL,CAAC,AG/BM,GAAG,EDmBF,ACnBI,EH+BJ,CEZG,EFYA,GAAG,CAAC,AEZE,CAAC,SAAS,CAAC,CAAC,OCnBG;AFW1C,AETA,CFSC,KETK,EH8BF,AEZA,CFYC,EG9BM,CDkBH,CAAC,CClBK,CAAC,CAAC,GDkBD,GAAG,MAAM,CAAC;ADPzB,AEVA,MFUM,AEVA,EH6BA,AEXF,GClBO,CH6BD,AEXF,CFWG,AEXF,CFWG,AG7BE,CAAC,CAAC,EDkBF,EDRM,CCQH,EDRc,EAAE,ECQV,CAAC,ADRoB,KCQf,CAAC,CAAC;ACjB/B,IDkBE,ADRA,CCQC,CClBG,IFUE,CAAC,CDmBH,ECnBM,CAAC,AEVE,CFUD,EDmBF,AG7BM,CFUD,CEVG,CAAC,CH6BL,ACnBI,CAAC,CAAC,GDmBD,ACnBI,CDmBH,ECnBM,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,IDmBA,CAAC,CAAC;AClBzC,AEVA,CFUC,GCSQ,ECnBH,EH6BF,AEVS,CFUR,AEVS,OAAiC,ACnB/B,GAAG,EAAE,CAAC;AFYtB,AEXA,MFWM,AEXA,EH8BF,AEXA,IFWI,CAAC,AG9BI,EDmBF,CAAC,ACnBI,IDmBA,ACnBI,CAAC,CDmBH,CAAC,ADRI,CDmBH,ACnBY,CDmBX,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AG5B9B,IH6BE,ACnBA,CDmBC,GEXC,EDRI,CAAC,ICQE,ADRE,CCQD,ADRE,EEVI,EFUA,CAAC,GAAG,CCQD,ADRE,CCQD,ADRE,EAAE,CAAC,CCQD,ADRE,CCQD,ADRE,CAAC,QCQM,CAAC,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;ADP1D,AEVA,CFUC,GDFC,IAAW,AEUT,KFVc,EEUP,CAAC,GClBO,CAAS,EDkBV,AClBY,CDkBX,AClBoB,EAAE,CAAS,CDkB3B,CAAC,AClB4B,EAAU,IDkBhC,CAAC,CAAC;ADNhC,IEXE,EFWI,EDHF,AEUA,EClBI,CAAC,CAAC,EHQA,CAAC,AEUA,AClBE,CDkBD,AClBE,GHQC,AGRE,CHQD,ACGI,CCOH,AClBE,CDkBD,CDPa,CEXT,CFWW,CDHX,AEUA,CFVC,AEUA,AClBE,CFWmB,EEXhB,CAAC,CHQD,AEUA,CFVC,AEUA,CAAC,AClBE,EDkBA,AClBE,GAAG,CDkBD,CAAC,AClBE,CAAC,IDkBE,CAAC,CAAC,CAAC,CAAC;ACjB9C,CAAC,GHQC,ACGA,CDHC,GEUC,EDPI,CAAC,CCOD,CAAC,ADPE,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,CCOD,CAAC,CDPG,CAAC,CAAC,EAAE,CAAC,CCOD,CAAC,ADPE,CCOD,EDPI,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,EAAE,CAAC;AAChD,AEVA,CFUC,GDFC,IAAW,AEST,MFTe,CESR,CAAC,GCjBO,CAAS,EAAE,CDiBX,ACjBoB,EDiBlB,ACjBoB,CDiBnB,CCjB6B;AFYnD,ICME,ACjBA,CDiBC,CDNG,EDHF,EGRI,CAAC,CAAC,EHQA,CAAC,AGRE,CAAC,GHQC,AGRE,CHQD,ACGI,CEXD,CAAC,CFWW,EAAE,CDHX,CAAC,CCGqB,KDHf,CAAC;AGP9B,CDmBC,ACnBA,GHQC,ACGA,CDHC,KCGK,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,EAAE,CAAC;ACUhD,ADTA,AEVA,CFUC,GDYQ,EEHH,WFGgB,CAAC,CEHH,IFGgB,EAAE,GEHV,GFGwB,EEHnB,yBCnByB;AFY1D,AEXA,IDqBE,EDVI,EDWF,EGtBO,EHsBH,CAAC,GEDK,GFCC,AGtBI,CHsBH,ACXI,ECUQ,CDVG,CCUD,CFCT,ACXY,AEXR,GHsBD,ACXoB,CCUD,EAAE,EFChB,CAAC,AEDgC;IDT5D,AEZF,IHuBI,AEDA,EDVI,CAAC,CDWD,CAAC,AEDA,ADVE,CCUD,ADVE,EAAE,GDWC,AEDA,ADVE,CDWD,ACXE,CCUD,ADVE,GCUC,ADVE,CCUD,CFCC,AEDA,CDVG,EDWA,ACXE,CAAC,EAAE,GDWC,ACXE,CDWD,ACXE,CAAC,GAAG,GAAG,EAAE,CAAC;AAC5C,CAAC,ODWG,AEDA,IFCI,AEDA,CFCC,AEDA,MAAM,GAAG,EFCE,GAAG,CEDC,CAAC,EFCE,CAAC,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;ACT9D,ICSE,CAAC,CDTG,EDWF,AGzBK,IHyBD,CAAC,GGzBG,GAAW,CFcH,GAAW,CDWX,CAAC,ACXY,AEdJ,CAAC,CAAC,CFca,CDWnB,AGzBQ,CHyBP,AGzBQ,CAAC,CAAC,MHyBF,CAAC,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IAC1E,AEDU,ADVV,CDWC,GGzBM,EFcD,CAAC,EAAE,CAAC,ECUY,ADVV,CCUW,EDVR,CAAC,CAAC,EEdA,CDwBuC,ADVpC,EEdA,CFcG,EAAE,AEdF,CFcG,AEdF,EFcI,GAAG,CAAC,CAAC,GAAG,GAAG,EAAE,CAAC;AAC5C,CAAC,GDYQ,AG1BT,CAAC,GDwBG,OFEgB,AEFT,CFEU,AEFT,CFEkB,EAAE,CAAS,EAAE,GEFtB,EFEmC,AEFjC,CAAC;CCxBvB,OH2BG,AEFA,MFEM,CEFC,CAAC,GFEG,AEFA,CAAC,CAAC,CFEC,CEFC,CAAC,EFEE,AEFA,CFEC,GEFG,CAAC,EFEE,CAAC,GEFG,EFEE,AEFA,CAAC,EFEE,AEFA,IAAI,CFEC,AEFA,CFEC,CEFC,GAAG,CAAC,CAAC,CAAC;ACvBnD,QH0BI,AEFA,MFEM,CEFC,CAAC,CCxBM,GH0BF,GAAG,EEFE,CCxBK,EH0BF,AEFA,GFEG,AG1BI,CDwBH,CAAC,EFEE,CAAC,EEFE,CAAC,QFEQ,CAAC;IGvB1C,IHyBE,AEHA,IFGI,CAAC,EEHE,CAAC,ACtBE,IDsBE,CFGC,CEHC,ACtBqB,CDsBpB,CFGC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC;IEFjD,CAAC,GFGC,AGzBA,IHyBI,CAAC,AGzBA,CAAC,MHyBM,AGzBA,CHyBC,AGzBA,CAAC,WHyBW,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC,GAAG,KAAK,EAAE,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC;CEFzE,GFGC,CAAC,GGxBC,qEAAqE;ADuBzE,IFGS,EEHH,ECtBF,CHyBU,GGzBN,CAAC,IDsBS,ECtBH,CAAC,IAAI,CACd,CDqBoB,GCrBhB,EDqBqB,ECrBjB,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,MAAM,CAAC,SAAS,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,SAAS,EAAE;ID0BjE,IFDE,IGxBI,EHwBE,EECI,CAAS,EFDR,AECU,CAAS,CCzBjB,CHwBC,AECkB,CCzBjB,IDyB8B,EAAE,ACzB1B,CAAC,GHwBG,CAAC,AECkC,CCzBjC,CDyBmC,CFDjC,AGxBA,EHwBE,AECgD,CFD/C,EGxBE,CAAC;QHyBnC,AECA,CCzBG,CAAC,EHwBA,AGvBF,CDwBG,CAAC,EFDE,AGvBF,GHuBK,AECA,CCxBD,CDwBG,ACxBF,GHuBK,AECA,CFDC,AECA,CAAC,CCxBD,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,MAAM,CAAC,SAAS,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,SAAS,EAAE;QHyB/D,AEAA,IAAI,ACxBA,CDwBC,CFAC,AEAA,GAAG,EFAE,EGxBE,CHwBC,CAAC,AEAA,ACxBA,CDwBC,CAAC,CFAS,AEAR,CAAC,CFAS,CGxBP,CHwBS,AGxBR,KAAK,EAAE,KAAK,GAAG,UAAU,CAAC;QDyBhD,CCxBG,CAAC,EHwBF,AEAE,ACvBF,CDuBG,CAAC,ECvBA,CDuBG,CFAD,EGvBE,CAAC,CHuBC,CEAG,CAAC,CFAD,AEAE,CAAC,CAAC,ACvBF,CHuBC,AGvBA,CAAC,EHuBE,AGvBA,CAAC,CAAC,EAAE,CHuBC,CAAC,IGvBI,CAAC,CAAC,EAAE,UAAU,CAAC,EAAE,GAAG,EAAE,SAAS,EAAE;QDwBhE,IFAE,AEAE,ACvBA,CDuBC,KFAG,AEAE,EFAA,CEAG,ACvBA,EHuBA,AGvBE,GHuBC,AEAE,CAAC,EFAA,AGvBE,CAAC,GHuBC,CAAC,CGvBG,EAAE,KAAK,CAAC;IDwBrC,CAAC,ICvBI,CAAC,EHuBF,AGtBA,IHsBI,AGtBA,GHsBG,CGtBC,CAAC,CHsBC,CAAC,IGtBI,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,EAAE,UAAU,CAAC,EAAE,GAAG,EAAE,SAAS,EAAE;IDwBxD,QFDN,AGtBE,IHsBE,AECc,CFDb,AECc,ICvBR,CHsBD,CAAC,AGtBE,CDuBuC,GFDrC,EAAE,AGtBE,CAAC,CHsBD,CAAC,CAAC,EGtBI,GAAG,SAAS,EAAE,KAAK,CAAC;QDwB/C,CCvBG,CA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","file":"f96e51eccd4577cc0442c4873fbd1eaa.map","sourcesContent":["import { Shape } from \"hovl/shapes\";\n\nexport interface Viewport {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  scale: number;\n}\n\nexport abstract class Scene {\n  public readonly context: CanvasRenderingContext2D;\n\n  protected shapes: Shape[] = [];\n\n  private readonly canvas: HTMLCanvasElement;\n  private viewport: Viewport = { x: 0, y: 0, width: 0, height: 0, scale: 1 };\n  private aspectRatio: number;\n\n  public get width(): number {\n    return this.canvas.width;\n  }\n\n  public get height(): number {\n    return this.canvas.height;\n  }\n\n  constructor(canvas: HTMLCanvasElement) {\n    this.canvas = canvas;\n    this.aspectRatio = this.canvas.width / this.canvas.height;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (ctx) {\n      this.context = ctx;\n    } else {\n      throw new Error(\"No canvas found\");\n    }\n\n    this.setViewport(0, 0, 1);\n  }\n\n  public setCanvasSize(width: number, height: number) {\n    this.canvas.width = width;\n    this.canvas.height = height;\n    this.aspectRatio = this.canvas.width / this.canvas.height;\n\n    this.setViewport(this.viewport.x, this.viewport.y, this.viewport.width);\n  }\n\n  public setViewport(x: number, y: number, width: number) {\n    const scale = this.canvas.width / width;\n    const height = width / this.aspectRatio;\n\n    this.viewport = { x, y, width, height, scale };\n    this.context.setTransform(scale, 0, 0, scale, -x * scale, -y * scale);\n  }\n\n  public start(): void {\n    const start = performance.now();\n    let last = start;\n\n    const frame = (now: number) => {\n      const time = now - start;\n      const dt = now - last;\n      last = now;\n      this.frame(time, dt);\n      window.requestAnimationFrame(frame);\n    };\n\n    window.requestAnimationFrame(frame);\n  }\n\n  public clear(): void {\n    this.context.clearRect(0, 0, this.width, this.height);\n  }\n\n  private frame(time: number, dt: number): void {\n    this.update(time / 1000, dt / 1000);\n    this.render();\n  }\n\n  protected abstract update(time: number, dt: number): void;\n\n  protected render(): void {\n    this.clear();\n\n    for (const shape of this.shapes) {\n      shape.draw(this.context);\n    }\n  }\n}\n","export interface Vector {\n  x: number;\n  y: number;\n}\n\nexport function Vector(value: Vector | number): Vector;\nexport function Vector(x: number, y: number): Vector;\nexport function Vector(x: number | Vector, y?: number): Vector {\n  if (typeof x === \"number\") {\n    return { x, y: y != null ? y : x };\n  } else {\n    return { ...x };\n  }\n}\n\nexport function dot(lhs: Vector, rhs: Vector): number {\n  return lhs.x * rhs.x + lhs.y * rhs.y;\n}\n\nexport function length(v: Vector): number {\n  return Math.sqrt(dot(v, v));\n}\n\nexport function add(lhs: Vector, rhs: Vector): Vector {\n  return { x: lhs.x + rhs.x, y: lhs.y + rhs.y };\n}\n\nexport function sub(lhs: Vector, rhs: Vector): Vector {\n  return { x: lhs.x - rhs.x, y: lhs.y - rhs.y };\n}\n\nexport function mul(lhs: Vector, rhs: number): Vector {\n  return { x: lhs.x * rhs, y: lhs.y * rhs };\n}\n\nexport function div(lhs: Vector, rhs: number): Vector {\n  return { x: lhs.x / rhs, y: lhs.y / rhs };\n}\n","import { Vector } from \"hovl/vector\";\n\nexport interface Trs {\n  translate: Vector;\n  rotate: number;\n  scale: Vector | number;\n}\n\nexport abstract class Shape {\n  public color: string;\n\n  public translate: Vector;\n  public rotate: number;\n  public scale: Vector;\n\n  constructor(\n    color: string,\n    { translate = Vector(0, 0), rotate = 0, scale = Vector(1, 1) }: Partial<Trs>\n  ) {\n    this.color = color;\n\n    this.translate = Vector(translate);\n    this.rotate = rotate;\n    this.scale = Vector(scale);\n  }\n\n  public draw(context: CanvasRenderingContext2D): void {\n    context.save();\n    context.translate(this.translate.x, this.translate.y);\n    context.rotate(this.rotate);\n    context.scale(this.scale.x, this.scale.y);\n    this.drawInternal(context);\n    context.restore();\n  }\n\n  protected abstract drawInternal(context: CanvasRenderingContext2D): void;\n}\n\nexport class Circle extends Shape {\n  public radius: number;\n\n  constructor(radius: number, color: string, trs: Partial<Trs>) {\n    super(color, trs);\n    this.radius = radius;\n  }\n\n  protected drawInternal(context: CanvasRenderingContext2D): void {\n    context.beginPath();\n    context.arc(0, 0, this.radius, 0, Math.PI * 2);\n    context.fillStyle = this.color;\n    context.fill();\n  }\n}\n\nexport class Line extends Shape {\n  public a: Vector;\n  public b: Vector;\n  public width: number;\n\n  constructor(a: Vector, b: Vector, width: number, color: string, trs: Partial<Trs>) {\n    super(color, trs);\n    this.a = Vector(a);\n    this.b = Vector(b);\n    this.width = width;\n  }\n\n  protected drawInternal(context: CanvasRenderingContext2D): void {\n    context.beginPath();\n    context.strokeStyle = this.color;\n    context.lineWidth = this.width;\n    context.moveTo(this.a.x, this.a.y);\n    context.lineTo(this.b.x, this.b.y);\n    context.stroke();\n  }\n}\n","import { Scene } from \"hovl/scene\";\nimport { Line, Circle } from \"hovl/shapes\";\nimport { Vector, add } from \"hovl/vector\";\n\nconst BOX_X = 1;\nconst BOX_Y = 1;\nconst BOX_WIDTH = 10;\nconst BOX_HEIGHT = 10;\nconst GRAVITY = 9.81;\n\n// Velocity Verlet\nfunction verletPos(x: number, v: number, a: number, dt: number): number {\n  return x + v * dt + 0.5 * a * dt * dt;\n}\n\nfunction verletVel(v: number, a: number, dt: number): number {\n  return v + a * dt;\n}\n\n// We need a circle that knows its velocity and bounciness\nclass Ball extends Circle {\n  public vel: Vector = Vector(0, 0);\n  public bounciness = 0.8;\n}\n\nclass VerletScene extends Scene {\n  private ball: Ball;\n\n  constructor(canvas: HTMLCanvasElement) {\n    super(canvas);\n\n    // These lines create a bounding box that the ball will bounce off of\n    this.shapes.push(\n      new Line(Vector(0, 0), Vector(BOX_WIDTH, 0), 0.1, \"#000000\", {\n        translate: Vector(BOX_X, BOX_Y)\n      }),\n      new Line(Vector(0, 0), Vector(BOX_WIDTH, 0), 0.1, \"#000000\", {\n        translate: Vector(BOX_X, BOX_Y + BOX_HEIGHT)\n      }),\n      new Line(Vector(0, 0), Vector(0, BOX_HEIGHT), 0.1, \"#000000\", {\n        translate: Vector(BOX_X, BOX_Y)\n      }),\n      new Line(Vector(0, 0), Vector(0, BOX_HEIGHT), 0.1, \"#000000\", {\n        translate: Vector(BOX_X + BOX_WIDTH, BOX_Y)\n      })\n    );\n\n    // Create a ball a bit above the center of the box\n    this.ball = new Ball(0.5, \"#00AA77\", {\n      translate: Vector(BOX_X + (BOX_WIDTH / 2), BOX_Y + 2)\n    });\n\n    // Give it a random starting velocity\n    this.ball.vel = add(this.ball.vel, Vector(Math.random() * 40 - 20, Math.random() * 40 - 20));\n\n    // Add the ball to the shapes so that it gets drawn\n    this.shapes.push(this.ball);\n  }\n\n  protected update(_: number, dt: number): void {\n    const ball = this.ball;\n\n    // Calculate the new position\n    ball.translate.x = verletPos(ball.translate.x, ball.vel.x, 0, dt);\n    ball.translate.y = verletPos(ball.translate.y, ball.vel.y, GRAVITY, dt);\n\n    // Calculate the new velocity\n    ball.vel.x = verletVel(ball.vel.x, 0, dt);\n    ball.vel.y = verletVel(ball.vel.y, GRAVITY, dt);\n\n    // These are the coordinates at which the ball hits a wall\n    const boundTop = BOX_Y + ball.radius;\n    const boundBottom = BOX_Y + BOX_HEIGHT - ball.radius;\n    const boundLeft = BOX_X + ball.radius;\n    const boundRight = BOX_X + BOX_WIDTH - ball.radius;\n\n    // Check for and resolve collisions\n    if (ball.translate.y > boundBottom) {\n      ball.translate.y = boundBottom;\n      ball.vel.y *= -ball.bounciness;\n    } else if (ball.translate.y < boundTop) {\n      ball.translate.y = boundTop;\n      ball.vel.y *= -ball.bounciness;\n    }\n\n    if (ball.translate.x > boundRight) {\n      ball.translate.x = boundRight;\n      ball.vel.x *= -ball.bounciness;\n    } else if (ball.translate.x < boundLeft) {\n      ball.translate.x = boundLeft;\n      ball.vel.x *= -ball.bounciness;\n    }\n  }\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const canvas = document.getElementById(\"canvas\") as HTMLCanvasElement;\n  const scene = new VerletScene(canvas);\n\n  scene.setCanvasSize(600, 600);\n  scene.setViewport(BOX_X - 1, BOX_Y - 1, BOX_WIDTH + 2);\n\n  scene.start();\n});\n"]}